import Foundation

func day4a(input: String) -> Int {
  let grid = input
    .components(separatedBy: "\n")
    .map { 
      $0.split(separator: "")
    }

  // Get vertical columns as strings
  var columns = [Int: String]()

  for row in grid {
    for (xIndex, element) in row.enumerated() {
      columns[xIndex, default: ""]
        .append(contentsOf: element)
    }
  }

  // In diagonals starting at top left the index *sum* is always the same:
  // e.g. [0,6], [1,5], [2,4], [3,3], [4,2], [5,1], [6,0]
  // is a diagonal path where index sum == 6

  var lhsDiagonals = [Int: String]()

  for sum in 0...(grid.count * 2) {
    // Get all tuples permutations that sum to this value:
    for yIndex in 0..<grid.count {
      for xIndex in 0..<grid.count {
        if yIndex + xIndex == sum {
          lhsDiagonals[sum, default: ""]
            .append(contentsOf: grid[yIndex][xIndex])
        }
      }
    }
  }

  // In diagonals in the opposite direction the index *difference* is always the same:
  // e.g. [1,0] [2,1] [3,2]
  // is a diagonal path where index difference == 1

  var rhsDiagonals = [Int: String]()

  for diff in (-grid.count)...grid.count {
    // Get all tuples permutations that diff to this value:
    for yIndex in 0..<grid.count {
      for xIndex in 0..<grid.count {
        if yIndex - xIndex == diff {
          rhsDiagonals[diff, default: ""]
            .append(contentsOf: grid[yIndex][xIndex])
        }
      }
    }
  }

  return [
    [wordMatches(in: input)], // Horizontal
    columns.values.map(wordMatches), // Vertical
    lhsDiagonals.values.map(wordMatches), // Left Diagonals
    rhsDiagonals.values.map(wordMatches), // Right Diagonals
  ]
  .flatMap(\.self)
  .reduce(0, +)
}

func wordMatches(in text: String) -> Int {
  text.matches(of: /XMAS/).count + text.matches(of: /SAMX/).count 
}

let input = """
XXXMMSAMXXMASXASAMMSMMSAAMXMAXSAXMSXMXSAXMMXXXXMXAXXXMASMMSSSSSMMMSMSMMSMSMSMMSXMXMMSMMMMAMXSMMMMSSXMASXSMAMSMAXMAMXSXAMSSMSSSMXSMSXXXXAXMMM
AMSMMASAMXXXXAXMAXAAMSAXXMXAMAMXAMMAMAMMSMSMXXASXSMMSMMSAMAAAMXMAMAAMMMSASXXMASAMXMMMAMXSAMMMAXMMAMAMASAMXASAMMMSAMXMMMAAAAAAAMASMXMSMSMMSAM
MAAAMAXXASMMASASMMSSSXAXMXSAMASMSMMSMAXAAAAAMSMMAMXAAAAXAMMMMMASASMSMMAMAMSXMASAMMXASAMXSASMSSMSMSXSMAMXMSXSASAXMAMAAAXMSSMMSMMASAMXSAAAASAS
XSMSMSSMXAAMAXMASMXMMMMSAMXXSMSAMXAMSSSSMSMSMAAMAMMXSXMMSMASASXSXSXMAMXXSAMXMASXXASMSASMSAMAXMAAXMAMMSMSXMXSXMASXXSXMXSAMXMAMAMXSASAMXMMMSXM
XXSXXAAXSSSMSSXMMMAXMASMMMMXMAMMMMXXAMAXAAAAMMMMASAAXASAXMASASXSASASXMAMAASMSAMAMXSMSAMXMAMMMMXMSMMMAMXMAMAMAMSSXMAMMSAMXAMMMAMASAMMSASAMXAA
XMASMMSMMAAAXXXMASXMMMMAAXXAMAMAXXMMAMMMSMSMSXXMSMMMSAMASMAMAMAMAMAMSMSSSMSXSAMXMASXXMAMXAMXAMAXXAXMAMMSAMAMAXAXAAAAMAMMSSXSXXMAMAMXMAXASMMM
SMAMXMAXXAMMMMMXAXAXSSSSSSSXSSSXSASXMMAAAAAAXMMXAXXAMXMSMMSSXMXMAMAMXMAAAAXASAMXMAMXMAAMXXXMAMMSSMMMMSASXSXSAMMXXMXSXAXMAMASAMSSSMMMXMMMMAXA
XMMSSSMSSMSAXAAMSSSMMAXAAAAAXAAASAMXASMSSSMMMAMSMMSAMXXAMAAXAMXSXSAAXSMXMMXMXAMXMMSMAMAMAASXXSAAXXMAMXMXXMAAXMMASMMMMXXMAMAMAMAASAAMASAMXSMM
MAXAXAAAXXSXXMXSAAAMMMMMMMMMMMMMMAMSMMMAAAAASXMAAASAMMSMMMSSMMAMMMMMXMMXSAMSSSMXMMAAASAMSMSAASMSSXSASMSSMMMAMSXXXAAMSSMSMMXSMMMMMSMSASXSAAAM
AAMXSMMMXMXMASXMMXMMSXMMXMAMAAXASAMAXAMMSMMMMASMSMSXMAMXAXMMMAXXAAASMSAXMASAAAMMXSASXXAXMAMMMMMAMXSASAAMXAMMASMSSMMSAAXAASMMMASMMAXMAMAMMSMM
SMSAXAXAMSAMSAAMAXMASASXMMXMSMSXSXSMSXSXMXXXMXMXAMMMMXMSASXASMSSSXSAAMSSXMMMSMMAXSAXXSMMMMMMXXXXXAMAMMASXXSMAMAAAMSMMSMMXSAASASAMSSMAMAMAXAM
MAMASAMXMSASXSXMASMASMMAMMAMAAXMSASXSMMMXMAMSMSXMAMAMSMSSMMXSAAAXXMMXMASAAMAMXMSMMASMMSASAAMSSSMAMMSMMAXAAXMAMMMXMXAXAAXASMMMMXAMMAMAMAMMSXM
MMMMMXMSMMXMAXXMAXAAMASXMSASAXSAMAMMXAMSSXSAAAXAXMSMMAMSAMAMMMMXMXXXXMASMMMAXMXMSMAMAAXXMSXSAAAXXMAAMMMMAMSMXXASASMSSSSMXSXMASXSMSAMXSASMSXS
MXAAAXMAMXSMMMMMMSMXSXMAXXAXASMAMAMAASAAXAXSMSSMMXAXSSXSAMXXAXSSSMMSAMAXXAMAXSAMAXSSMMSSMMMMMMMMXMXXSAMSAMXMASXSASAAXMAXAXASXSAAAMMSMMASAMXM
XSSMSSSMSMMAMXMAXAMMAASXMMSMMMMAMXASAMMMMAMAXXAAASAMXMASMMSMMMSAAAAMXMMMSXSXXSASMXMAXMAAAASMSAXAMMMASAMSAMAMMMMMMMMMMSMMSSMMAMXMMMMAASXMMMAS
AMAMAXXXAAXAMXXXXMSAMXMAAAXAXASMSXAMXXXXMAXXMMSMMSMSSMAMXAAAAMMXMMMSMXAAXMAXMXXMXMSASMSSSMSASAXSASAAMAMSAMAMAAAAMSMMAMAAAAXMXMSXAAXMMMAAMSAS
MSAMMMMSMSSMMSSSSMAXXASXMASXSMSAAXXXMAXSMSSSMMASXXAAMAMXMMSSMSASXSXAMSMMXAMXMMSXMAXASAMAXAMXMXAMMXMSSSMSASMSSSSSMSAMMXMMSSMMAMAMSMSMMSMMMSXM
XSXMAAAAAMXXSAAAASASMXMXMXMAAAMXMMXMAMXSAMAAXXAMMMMMSMSMMMMMMMMMAASAMAMXXSASAASAXMMMMMMAMXMSSMSMSMXXAMAMXMAAAXAXASAMMASXMXAXXSMXAMAXMAXMMMAM
XMAMSSXMSMMMAMMMMMMMXAMXAAMSMMMAXAXSSMAMAMXMMMSMSASAMAAAASASXMMMXMSXMSXSXXASMASMMXXXAAMXSSMMAAAAAAMMMMAMSMMMSMMMAXXMSAMASMSMASXSASAMSXMSASAM
MSSMMMMMAAAXMXSAMMSMSMAMSXXXAMSMSXMAMXASXMAXXXMASASAMSMSMSAMMXSAMXMMMMMMAMMMMAMMSAMMSMMAXAAMMXMSMXMMAMAAMAMXMXXSSMMMXMMAMAXMAMAXAMAXMMASASXS
MXMXSAAXSSMSMAXASAAMAMAMXMMXSMMXSXXSXSXSMSMSXMMMMXMXMXAAAMAMSASAMAMAAAAMAMAXMMSAXMAXAMMMSSMMAMMAXXASXSSMSAMAXAXMAASAAAXSMMXMMMMMXMXAAAXMAMAS
XASAMXMMMXMAMMXMMXXSMXAMAAMAXAAASAMXMMMSAASAASAMXAMASMSMSMMXMASMMASMSSSSMSMSMXMASMXSASMXAMXMMMMAMMXMXXAASAMASMSSXMMMXMSAAXXXXAAXXMMSMSAMXMSM
SMMMSAXAMMSAMSASXSMAMSMSMSMASAMXSMAAAXASMMXSXMAASXSASAAMXMXXMXMMSASAMXMMMMXSXAMAMXAMASXAMMSASASXSXMSMMMMMAMXAXMAMSMSMSMXMXMAMSMMASAAAXXMXMAM
AXAXXMXASAXXMSXXAAMMMAAAAMMMMAMXSXSSSMMSASXAMMMXSXMASXSXMMSMXSAMXAMMMAXMASAMMXASMMXMAMMMMASXMASAAMXAAAXXXSMSXMMAMAASXSAMXAMMXAMMAMSXMXAMXMAM
MSMSAAMXMAXMMSXMSMMXSXSSXSAMXAMMSAMXMAMSAMXMAASXXAMAMAMXSXMAAMMMMXMSSXSMAMAMAXAMASXMASMXMXXAMXMMMASXMMSSXMAAXMSMSMSMAMAMSSSSSMSASMXXMSAMXSAS
XAAMXMASMMAMXMAAAAMAXAAAXSASXSMXMXMAMMMMXMXXSMSMSSMASMMAMAMMMXASXSMXMXMMASMMSAASAMXSAMXAXMMMMAXXMMASAXAXAMSMMMAMAXXMXMAMAAXAXASAXAXXAAAXMMAS
SMXMAXMAAASMMSSMMXXAMSMMMSAMAXMXMSSMXSASXMMMXXSAMASAXXMXXAMAMXAXAXMAMAMMASMAAMMMMMAMASMSSMASMMMXXMASXMASMMMAXMAXMSSMXXMMMXMAMMMMMMMAMSMSSMAM
XSSXSSSMMMMAAAMMSAMSXXAXXMSMAMSMMAAMASMSAAAAMAMAXAMMSMSMSMSASMSMSMSASXXMXSAMSXMASMMSMMXAXMASASXSXMAMAAXAMASAMXXSXAAXSMMMSMMXAXAAAAAMMAAXAMSS
MXSAAAXXSXMXMASAXMAXAMXMSXMMMMMXMXMMMXMSXMMSSXXAMSSMAXAAAXMASAAAAASAMAASAMAXMMSAMXMMASMMSMMSAAAXXMAMMASMSASASXXAMSSMAAXAMAMMXSSSSSMSAMXSMMAX
XAMMMMMSAAASXMMXSXSMXMAAXASXMASMSSMXXMXSMMMAMAMSSMAMXSMSMSMMMMMSMXMMMSMMASXMAXSSSXXMASAXXAAMMMMMMMSXSASXMAMMMMXSAMXMSMMMSAMSMMMXMXASXSXMAMXM
MMMXXXXMMSMXASMXMAXAMXSMSAMASXSAAAXMXMXMASMAXAAXAMAMMMXAMXAAAXXMMXMXMAMMAAXSMMMAMMXMASMMSMMXSAMASXXAMXSAMSMSAMMAAAXMAXMAXXSXASMSSMXMASASXMAS
AASMMMSXMXXSMMMAMAMAMMAXXAMAMSMMSMMSMSMSAMMSSMMSAMXMAMSSSMMMSXMXSAXSAMXMMSMAAAMAMSASAMXMXAAAXASASMMXMAXXMAMSAMAMMMMSMSMMSMMMMMAAAXMXMSAMMSAA
XXAAAAXXMXMMMASMMMSSMAMSXMMMMXXAMXASMSAMXSAXXXMAMXXSXMAXSAMXMXMASMSMXXMASMAXMMMXMMAMXAAMMSMMSAMMMAXSMSSMMAMSXMMSAAAAMAMMAAMMMMMMMMMAAMAMAMSS
MSSXMSXXMAAASXSMAAMAMMXSMMAXXSMSSMMSAMSMAMASMMSMASXAMMSMSSMAMAMXXXXMAMMXMASMMSMSMMAMMSMSAMAXXAMXSSMSAMAMSMXXXAMMMMSSSSSSMSAAASXMAMXAMMAMXXAX
XAAMSAMSMMXASMXXMXSAAXXMAXMSXXAXSAAMXMAMXMXXAAXMASMMXAAAXAMSSXMSMSMXSMMXXAAMAAAAMXASAAAMASASMMMXMXAMSMAMMMSSMSMMSMXAAXAXAAMXMXASXMSASXAAMMSS
SMSMMASAASMMXXAXMAMXSMSMSAXAAMMMSMMSXMAXMMMSMSSXXXAXMSMSMXMMAMXAAAMMXAMXSSMMSMSMSSXSMMMMXMXXAASAMMAMXMSSXAAXMASAAAMMSMMMXMMSSSMMXAAAMXXMAAAM
XXAAMSMMAMAMAMMSSSXAAXAAMMAXXMMASAMXASXXSAAAMMMMAMSXXMAMXAXSMMSMMMSASAMAMAXAXXMAMAAMAXXSAMASMMMASXMXMAAMMMXSXMMSSXSAAAASMXMAAAXSMSMMMXMSMMXX
XSSMMMAXMSSMAXXAAXMAMXMXMXXMSXMAMMMSMMAASMXMMAAMAMXMSMMMSXXAXMXSAMMMSAMASXMMMSMSMSXSAMMAMMXAMXSXXAXAMMMSXSMXAXXXXMMMSSMSMAMMMMMMAAXAXXAAXMSS
XMASMSMMMAMXMSMMSMAAAASXXSAAMAMSMSASMMMMMSMASXSSMSAXXAXASMXMMAASXXAXXMSMSXAAAAAMXMXMASAAXSAMXMAMXMMXSAMXAMXSMMMAMSAAMAMXMSSMXSXMSMSSSMSSSXAA
MMAMXASXMAXAMAMAAXMMXXSAAXMASAMMAMASMSMMAXMAMMAAASMXSAMXXAMXXMXSASMXMXAAMXSMSMMXAMXAXXMASXSXXAAXMXSSMMSMAXAMAAXASMMMSASMMMXXMXAMXAAMAXAAMXMM
SMAMSMMXSASXSSMSXSXMSSMMMMXAXASMMMMMMAAMXSMASMMMMMMXMXASXSMSASMMAMAASXSSXAXXXXAMXMSXMSSMSAMSSSMAMAMAAAXMSMMSSMSXSAAXXASXSXAMMSMMMMMMSMMAMAXX
SMMXAAXMMASAAXMMASAMXAAXMASMSMMMXAXASXSMAXXAXXXMAMXAMXSMSAAXASAMXMSMMAAMMMMSAMSAMXSAAAAAMAMAMAMAMASMMMSXXAAAAAXXSMMSMSMAMMMSAAXAAAMXXXSASXSX
MAMXSMXAMAMMMMAMMSMMMXMASASMAXMASMSMXMAMMMMSSMMSAMSASMMSSMMMXMXXAAXXAMMMAMAAAXMASXSXMMSMSSMMSASMSAMAAXAMSMMSMMMXXMAMMAMAXMASMSSSSMSXMASAMMMM
MAMXMSXMAMXMMSMSXMMSAXXXMASASMSAMXAMAXAMSAMXAAXMMASAMASXXMASMMSSMSMSXXXXSMXMXMXMXXMASMMAAAAASAMAMXXMMMMAAMMXXMMMAMMXSASXMMXSAXXAMXSAMAMSMSAM
SASAAMMSMSMSAAXSAAAXMAXMXSXXMASAASMSMSMSSSSSMMXAMAMASXMMASASAAAXAAAASAMXMXSXSMSMMXSAMAXMSSMMMMMSXMMSAMXSMSMAMXAMASXASASXASAMMMXMMXSAMASAXSAS
SSSMSMAAAAAMSSXSAMMSXSXAXXXXMAMSMSAMAAXMXAMXAXSXMXSAMMASAMSSMMMMXMXMMXMAMMAAAAAAMAMASAMXAMXSXXAXAMAAAMMMXAMSMSXSASMXMAMMXMASAMSAMASAMXXMASAM
XMXAMMSMSMSMAMASXMAXAMMXMSMSMSMMMSMMXMSXXSMSSMMASAXMASXMASAXAMMSAMAXAAMAMAMSMXXMMASAMXXMASASXMSSXMMSSMASXMMMMMAMASAMMSMAMSSMAMXAMASAMXSXXMAS
MAMXMAMXMMMMXXAMXMXMXMAAMAASXMASAMXMSMMMMMAMXASXMASXMSAMXMMSXMASASMSSSSSSSXAXAXSSMMAXXXMAMXSAXAMAMMMAMASAXAAAMAMXMXMAAXXAXAMSMSSMXSAMSAMXSAM
XSXSMMSMSAAAXMSMMAAXAMMXSMMMAMAMAMMMAAAAAMMMSMMMMMMAASMMASXMAMMXXAAAXXAXAMXSMXMAAASMMAXMAMMMAMXSAXAMAMXSMSSSSMMSXSSMSMSASXXMMAAXXXXXMAXXAMXS
XXAMXMAASXMSSXMAMSMSSSMAXMASXMSSXMXMMMMXXSMMAAAMAAMMMMXMXSAMXMXXSMMMSMSMMMMAASMSMMAAMAMSSMMXSXMSMSMSXSAXXAMMXAAXAXMAAAAXXMASMMMXMSMSMSAXXMMA
XMSMAXMXMMSXMASMMAMMAAMSMXXMAAAMXSMSMXMSMXAAMXSSSSSXSXMXASMMAMXMMAAAXXXAAAAMSMAXAMSAMAXAAASAXAAXAXAAXMAMMMSAXMMMSMMMMMMSMSMSMSMSAAXAAMMSMSXA
SAMMSXSAAXMASAMXMAMMSAMMASXSMMMMMXAAAASAMSMMXAXMAAXXMASMAMMMMXAASXMSSSSSMSXXMMMMXAMAMMMSMMMAXMMMXMXMXMXXSXMXSSXXAAMASXMMAAAMAAAMXMMMMXXAAAMX
SASAXXSSXMMXMXXMSXSAMAXSAMXAASAAMMSMSMSAMMXAMSMMMMMSXAAMSMSASXMXMAAXAXAAXMASXXAMSXSSMXMMMSMMMAXAMXAXASAMXASAAAXSASXASASMSMSMMMSMAXXAASMMSMSA
SAMASMMMXSSSMMMMAXMAMAMMMXSMMMSMSAXMXASXMSMSXMASAMXSMSSXAASAXXXXSMMMXMSMMSMMASMXMMAAAMMMAAAASMMSASMXAXAMSMMMMMMSAMMXMAMMASAMXAAMSMMXMSAAAAMM
MAMAMAXXXAAAXAAMXXSAMAMASMSXSXAXMXSAMMMAMMAMAXMSASAXAMMMMXMAMSMXMASXMMMXAMXXMMMAASMMMMXMSMSMSAMAXAMMMMSAMXXAXSAMASMSMAMMMMSMMSMAAAMXMSMMMXMX
MXMXMAMSMMSMSSSMMASXSMMMSAMAXXXMXXMMMAMMMMAMMMXSXMMMXSAAMASMMSAAXXAXAXMMMMXMXAXSMMAAAXXMXXXXSMXSMMXAAAMXMXSMSMASMMAAXSXXAAXXXXMSSSMAAMMXXSXM
SASMMSMSAAXAAAMASAMXAAAXMMMSMMMMXMSXSSSSXSASMSAMXSMAAAMAXAXAAXSSSMMASMMXSASMSSMXASMMMMXSAAMXMXMXAMSSSMSASASMXXAMAMSMSMMSMSSMSXMAMXMMSXMSMMMA
SASAAMASMMMMMXSXMASASMMSAASAMMAMAXMAAXAMASAAXMASAMMMXMSSMSSMMXAMAAMMXMAAMASAAMAXAMXMAMMSMMMAXAASAMXAXASXMASAMMSSSMXSMAAAMMAAAXMASAMSMXMAAASM
MXMMXMAMASXXAXMAMXXAMAAMMMSASMSSMSMMMMAMAMXMASAMXSMMSMAAAXXASXSSXMMXXMMSSSMMMMSMMXAMAXAXAAXMSMMMXAMXMXMMMXMXMAMMXXMAXMXSMSMMMSXAXAXAAAMSXMXX
MASAXMASAMAMXXXAMXMSMMMMMXSXMAMAXAXMAAXMXSXMMMMSAMAASMSMMMSMMAMMASMMMSAAXAASXAXMAMMMMMMMMMXXAMAXASXSMXMAMASMSMXXXMSSMSAXAMSAAXMMSSSMSMXMMSSS
SASAMXAMMSAMSSMSSSMASAAXXAMAXSSMMMMSASMSAMAXMAXMAMMMSAAAAAXXMXMSAMAAAMAMXSMMMAMSAMXASASXAXMASMXSAMAASXSMSAMAAMXMSAAAAMASASMMMXMMAAAAMXAAMXAA
MAMMXMASMSAXXAXXAMXAXMMMSSMMMAAMMXASMMXMASMMSSMXAMSAMXMMSMMXMXMMMSSSMXSSMMSSXMASAXSAMAXMXXMXMAXMAMSMMXAAMAMSMMAAAMMMSMXMMMAAMSSMMXMMMXMXMMSM
SSMSXSASASMMSSMMAMMMSAAAAAMXXMAXMMMXAXSSMMAAAMMSMSMSSSMXXAMSSSMAMAMAXAMAXAXSAMXSAMMSMSMSSSSSMMMMAMXAXMMMMAMXASMSSSSXMXMMMSSMSAXAXASXSMSAAMAS
SAAXAMAMAXMAXAMSSMAXSXMXXSASMXSMAMASMMXAASMMMSAAXSXXMASAXAMXAASMMASAMXSMMMSSXMAMXMAXSAASAAAXAXASASXMMMXAXMMSAXAAAXMASMMAAAAMMMSMMMAAAAMMMMAS
SMMSXMAMSMMSSMMAASMMMASXMAMAAAXSAMXAXMSSMMXXSMMSXMAAAAMMSSSMSMMMMMMXSAXXAXAMAMXSMMXSXMXMMMMSXSASXSXSASXMASASXMMMSMSAMASMSSMMAXAAAXMMMMMXSMSM
XSAMXMXSXAAAAXMSMMXASAMAAMXMMAMMXMAMXXAAASAMXAMMXSAMMSSXAAMMASASMMAMMMSSSMXXAMXXAXMAMXXMXMAAMMAMASASASAMXMMMXMXAAXMASAMXXAXSAMXSSSXSXXMAMXAX
MMMMXMXMXMXMMMMXXMMMMAXAMXSXSSSSXSAXSMSSMMMASMMMAXASXAAMMSMSAXMSAMXSAAXAMAMSMXMASMMSXMXXAXMSXMAMAMMMXMMSXMXSAMMSMSAASASMMMXMXXMXXMAXAMMMSSSS
XMASAMXXAMSMSSXSASAASMSSMMSAMAAAASXMXXMAXXMMMSAMXXSMMMSXAMXMMSMSXMAMMXXMMAMAASXMXAAMAMASMSXMASAXAMXMASMAAMAXASMAMXMASAMAAAMMMMMMAMAMSMMSAXAM
MXAAAAXMMAAAAMAXAMXMXXAASAMXMMMMMMMSMMAMSSXAASMSAXMAAXXMASAMXAASXMASXSMXSASXMXAXSMMMAMAAXSAXMMMXAXXMASMSSMASMMMASMSAMXMSMMSMAAAXAMXXMASMMMMX
AMASAMXAXMMXMXAMSMSXMMMMMMMXSXMXXSAMASXMAXSMMMAMMAXSMAAXXSASMMXMASAXAAXASASXXXMMSAMSXSSMMMAMSAMSAMXMAXXAMXAXMASXXAXXAAMASXAXSSMSMXSAMXMAAXXM
XAXXXAXSSSSMMMSSMAAASAMXMSAXMASXMMXSAMXMSMMXSMAMXMAAXXMAXMMMASXMMMSMSMMMSXXMMXSAXAMAXMAASMSMSAMAAAAMASMMXMAMSMMASXSAMXMAXXMMMAMSXAAAXAXSMSMA
MSAMMXMMAMXAAAXAMAMMMXSAAXMASMMASAAMMMSAXAMAXMXXAXSXMMXMMASMSMAXSAMXXAAAXMMXMAMAMSMMMMSMMAXMXXMMSSSMMSASXSSMXAXXAASASMMSSXSAMXASMMMSMSXXMSMS
XMASAASMMSSSMMSAMXXAXASMSMXXXASMMMMXASMMSMMMMASXSXMASMAMMMMMAMSMMASASXMSSXMAMAMXMXASMMMMMMMXXSAMMXMAXSAMAAAAMSASMMSAMMAAAMSXMSSXAAXXAXASASAA
XSAMXMSAAXMASAXASMMSAMXAXAMXSMMASXSSMSAXXMAMMAMAXMXXMSASASAAAAXASXMMSASAXASXSAXSASAMMAAXAASMMMASMMXXMMAMMMMSMMAXXAMXMMMMMMXXASASXMSMAMAMAMSM
XMSSMXSMMSXAMSSXMAAXMXMMMMAXMASAMXMAMSXMXMASMSMSMSMMMXXSASAXXSMXMAAXMMMASMMMSMSAMMSMSSSXSMXAXSAMMASXMSXSAMXXAMXMMAXMSASASMXMMSAMXXXMAMAMXMAX
SXAXMASAMXMMSAXMMMMMAAXAAXMMMMMAMXSAMSASXMAMXAAAAAXSXSMMMMXMSXXASMMMXXMAMXSXSSMAXAXMXAAMMASXMMASMAMAAAAXXAMMMMMXSXSAAASAAMAMXMAMXMSSMMAXAMAX
SMMSMMSAMAASMXSMSAAXSSMSSXSAASMSMAXXSMMAMAMSSMMMSMMASMASMAAMMASMSXMMMXMMMAMMMAMSMMXXMMMMXAMMASAMMSSMMMSMSMSASMSMMMAMXAMXSSXSASAMAMAAXSMSSMSS
XAXAXXMXMAMSAMSASMMMAMAMAMXXAXAMMMMMMXXXXXXAXAAMAMXMASAMMXXAMXMXSMSAAXSAMASASMMMASAASXSSMSMXXMASAMMXAXAAAASAXMAAASMMMXXXMAASASASXMXSMAAAAAAX
SSMMMXMAXMMMAMMMMSXXAAMMAMXMSMMXASAMXSXMMAMMSMMSAMAXAMXSASXSXMAXXASAMXMXSASMSXXSAMSSMASMAMXMASXMASXSAXMMMMMAMSMSMSXXMAMXMMMMXMAMMMSXXMASMMMS
XMASMASAMXASXMXSMMXSMMXSXMXAAAXSMMAXAMMXMAXMAAMSASXSMMMSASAXAMXSMAMMSAMXMASAXAMSXMXMMMMMAMAXXMAXAMMMSXASMMSSMAAMXMMMSAMMXMXMAMXMXMAXAMXAMXXX
XSAMSMMAXXAXAXAAAAAXASAMMMXXXXMAMMSMAXAAXMMSXSMSAMAAAXAMXMAMXMAXAMAASAMMMSMAMMMMXXXXASAMMSSMXMMMMXSAAMAMXAAMMSSMASAXSAMAAAASASASXMMSAMMSMMMX
MMMXASMASMSMAMSSMMXSAMMMXSAMXXSASAMSSSSMSAASAXMMSMXSMMMSMMAMAMAMMMMMXMMSSMXSAMAASMMSMMASAAAMXXSAMAMSSSXMMMMXAAAMXMSXSAMSXSMSAMAMAAXMXMAXMASM
SAMXAXMASAMMSMXAAAXMXMAMAMASAASAMMMAMXAMXMAMAXXAAXAMXXXAASXSMSASMAXXSMMMAMAMASMXSAASMSMMMSSMMAMAMXXAMXAXMSSMMSSMXXMMMAMXMMMMMSMSAMXSAMXXXAXA
SASAMXMXMAMAAMXMMMXXAXAMASASMAMXSAMXMMSMXSSMSMMSSSMMASXXXXAMXSASXMAMAAASAMXMAMXSSMMMAAXMMAAMAAXAMXMASXSSMAMXAMXXXSAAXAMXAXXAAMXAAXMMMSMSMMSM
SXMAXXAXMMMSSMASASMSMMSXMMASXXMAXXMSAXAAXAAAXSAMXAAAXSASXMMMAMMMMMSSSSMSXSSMSSMMXSAXXMASMSSMSMSMMMSMMAAAMASXMAAXMXMSSSSMSASMSSXMMMAAMAAAAAAX
XMSSXXSMMSAAAXMSAXAAMAXAMMMMMAMXSAXAASMSMMMMMMMMSSMSAMAMMAXMASAAAAAMXXAXAAAAAXMMASXSXAAMAAMXXXAAAMASXMMMMASAXMMSMSAMAAAAXXMAMXMXSXSSSMXMSSMS
SXAAMXMAAMMSMMMMXMSMMASAMASASXSMMXMMXAMAAAAAAXAAMAMAAMSSSSMAMXMSSMSSSMMMSMMMMMSMAXASAMXMMMSMXMMXMSASMSAXMASXMASAAXAMMSMMMSSSMMAMXAMAAAXXAMXX
AMAXMAMMMSXXASXXMAAXMASXMASASAAXXAAXMMSMSMMXMXMSSMMSXMAAXMAASXMXMAMXAMXAXXXXXAMMSMXMXSAAAAAASMSSXMAMASMSMMMMAMMMSMXSAXASAAMAAXSMMSMSMMMMAXXX
MMAMSASMMMASAMXMASXSMMXAMAMXMMMMMMSSMMAXXMXSMSMAXAAXAMMXMXSMMAXXMXMSMMXSXMMMMSAAXAMMSSMSMSSXXAMAXMAMXMXAMAAMSXAAAXMMASAMMSSSMMMAAXAAXSXSSMSM
XMAMMASAAMMMMMSAXMXMAMSMMSSMASXAAAAAAXMXMSXSAAMASMXSXMMXXAXMSMMMSAMAXSMMMSAAAXMASAAXXXMAMXMAMSMMXSASMMMMSSSSMXMSSXXMXMMMAAAAMASMMMMMSXAAAAAM
XSMSMXSMMXSAXAXSMMMSAMAAAXAMASMSMSSSMMSMAAAMAMMMXMASMAXMMSSMASXAMASMMMAAAXMMMXMASXMMMMSMSAMXMMAXXMXSXMXXAXMAMAMAXMXSSSXMMXMMMXMXXASMXMMMMSMX
MSAXMAXASASXMMSAMAAXASMSMSXMASAMAXAMXAAMSMSAAMAXASASMMMXAAAMAMMMSAMXASXMMSXSMXMAMXXAAAXXMXSSMSMMMMMSAMAMMSSSMMMASXXMAMMMSAMSXSMMSASMSASXMAMM
AMMMMASXMAMXSXSXSMSSXMAAMMAMAMAMMMSMMSSMXAMXSSXSASAMAMSMMSSMXSAMAMASXMASMSAAAXMASMSMSMMMMMMMAAMAXAASXMASXAXAAXMAMXMMAMAAMAXSAMSAAAXAXASXSASX
SAXXMMMMMSMMMAMAXAXMMMMMASAMAMSSXAXXXAXMAXSAMXAMMMMMAMAAMXXMXAMSASXMASAMAMSMMSSXSAMAMXMAAAASXMSSMMXSAMXSMXSSMMMASAXSASMSSSMMAMMSSSMMMSMAMASX
XXMSMAAXAXAAMAMXMAMMSAMXMSSSXSAAMMSMMMSMMMMAMMXMMAMSSSSSMMSXMMMSAMMSAMMMSMXMAXASMAMAMSMSXSMSAXAXSMAXMAMMMMMAMSSMSXXMMMAXAMXMMMAMXMAXSAMSMAMX
MAMASXXMSSSMSMSAMXXMAMXAXXMMXMXMAAAMAAAAAXSXMXXXMXMAAMMMXAMASXXMXMAMXXXAMASAMXMMSXMSASMXXXXMXMAXMMXSXSAMXAXAMXAXSXSASMMMAMSSMMASXSXMMAMAMXSX
MASASMSMMAMXXAXAMXXXMSMMMSAMXXMSMXSMMSSSMMSASAMSASMSMXAMMMSAMAXMMMMMSXMASMMAXAXAMXMMXXAMASMSMSSSSMAMAXMAMSMSXSAMXASAMSXMXMAAXSXSAAMSSSMMXASX
SMXXMXAMXMAXMSMSSMMMMAAAAXASMSMAXXMAXAXAXAMASMASMAAAMXMMMXMASMMSAXAASAXASAMXMMMMXAXSSMSMAMAAASMAAMXSASXSXMAMAXAAMMMAMAXSXSMSMMASMXMMAMSXMMMS
XXXMSSMSMSSSMXXMAXAASMSMSMXMAXXAXMMXMASXMMMAMXXMXMSMSASAAMAAMXAXMSMSSXMXSAMMASAASXSAAAXMAMSXSMMSMMAMASAMXMSMMSMMMXASMMASAMMMAXAXMAXMAMMMXAAS
SXSAAAAXMAMAXXMSMASMSMMAXMMMSMSSXSAASAMASXMMXSAXAXMASASXSAMMSMXXXAMAMMSASXMASXXXAMXMMMXMMMMMXXAXASAMMMXMSMXAXAASMMXXAXAMAMSSMMSXSXXMASXSSMSS
SASMXMMMMMSSMSMAXMMXMAMAMASXXAMAAMSMMASMMAMMAXMSSSMXMAMAXXXSAMMSSXSAAAMASMMMAMMSAMXXAMXMMAMMMMMSMMAXMAXSAMMMMSSMAMASMMMSMMAAXAMMSAAMASMAASAM
MMMSAASAMXAAAXSASXMASXMMSAMXMMMMMMXMSAMXXAMMMXXAMXXAMASMMSMSASAMMASXXAMXMASMAMASXMXMAXAAMASMAMMAMMXMMAMAMMXSAMAMMMXMAMAAXMSMMXSAXSSMASMSXMSS
MXAXSAMXSMSSSXXMXAMASMAAMAMXAXAXAMAMMXSASMSSSSMSXSAMSAMAMSAMAMMSMAMXSAMXSAMMAMXSASASXMSXSASXSMMASXSMMSSMXAAMMXAMXMMMXMSSXMAAASMMMAMXAXAXAMXM
MMSMXMAXXAMMXMAXSAMXSXMMMAXSSSMSMSASMAMXSAAXAAAMASXMMMSAMMAMSMMSMMXAAMSXMASMSSMSAMMSAAAAMAMMMMSASAAMAMXXMMXXSMSSSMAAAAMAMSSMMSAMMAMXAMXMAXAS
SXMAMMSSMAMAXSAMXSAMXAMSMMMMAAMAAXXXMASMMMMMSMMMAMAXAMMXXMXMAAXSASMXSAAXXXMAXAXMAMAMMMMXMAAAAXMAMXMMSSSMSSSMSXAAMXAMASMXMAXAAMMMMXSSMAMSMSAS
AAMSMAAAMXMAMMMSSXMMXMASASAMSMMMSMSMMAXXAAMXAMSMMSAMXSSSSMSSSXMSAMAMAMMXXXMASMMSXMSXSASXSXMMXXMAMXSXMAAXAAAAXMMSMSMSAMXSMXXMMSXMMAMAMSAAMMXM
MSMAMMSSMXMASAXMAMXXAXMSAAMMMMMMMASAMSSSSMSXSXXAAXXAAXAAAAAMMAXMMMAMXMXMAXMASMAMXAASAAAXMMSSSMSMXAAAXXXMMSMMMAXXAAMMXMAAXMASAXAMMSSXMMMXMMAX
MXXMMMXMAXXMSMSMXMXSASMMMXXAMASAMMMAMAAXAASAXASMMSMMMMMSMMXAXXMXXXXMAXAAMXMAXMAMXMMSXMMSXMAAAAXMMSSMMMMAXXAXXSMMMMSSMMSMAMXMASXMAXMMXSXMASXS
SMMSMMMXMMSMMAAAASASXSXAXMMXXAMASMSMMMSMMMMASASAAXAAAAXXXMSXSAMXSXASMXMSMMMSSSMSMAXMXMXXAMMXMMMXAMAAAAASMXMXMAXAMXMXAAAMAAXAAMAMSSMASAASXMAS
SAAAAAAMXMAAMSMSMMAMASXXSASXMSSMMXAAAAAXAAMXMASMMSSMMXXAAXAASASAMSMMSAAAAXAMAAAMAXAMAXSSMMSXSSSMSSSMSMSAMASAMMSSSMMSMMSSSSSMXSXMAXAXXSMMSMAM
SMMSSMXXASXSMAXXXMSMSMAMSXMAXAAXMSSSMSSSMMMAMMMAAAASMMXSMSMXSAMXMAXAXMSSXMXMSMMSSXMSMSMXMXMAXAAAMAXAXMXAMXMAMMAAAMMAXXXMAAXMMMMSMMSXMMXAXMAS
XAAXMMXMMMAAXAMXAAAXAMSMSASMMSAMXAAMMMAAXSSSSSSMMSXMMSAAAXXXMXMXMSMMSXXMASAMXXAXXMMAMXMAXAMSMXMSMMMMMMSXMASMMMMMMMSMSMXMMMMAMAAAXAMAMXMMMXSS
SMMSMAAXXMSMMMMMMMMSSMXXSXMXMMMSMMSMAMMMMMAMAAMMXXXAAMXMMMMXMAMAXAAXSAXSAMAXMMMSMXSAMSSXSASAMXXAAXAXAXMASMSXMAMMMXAAAAMXMASASMSSMMSSMXMXSMXS
XMAXMSXSAXXXMMMAAAXXMASAMSMAMMASXAXXXSSMAMXMMMMSAMMMMMMXMASASAXXXMSMXAXMASXMXAMXAAXAMAAASXSAMXMSSSXSAMMXSAMAMAMSSSMSMSAASMSXSXMAAXAMXXSAMXAX
SXSXAAMMXMXASASMSMSAMXMAMAMAXMAXXAMXXXAXXMASXXAMASXSAMXAMMMAMMMSXSAMMXMSAMMASMXMSMXMMMSMMAMXMAAXMMXMXSSMMASAMASXAAAMXXMAMXMAXAMSMMASXXMMMMXS
MAMMMMSSMXSAMASXAASMMSXMMMXSXMXSAMASMSMMMSMSMSSSMMXSMSSSSMMSMMASMSASMAMMSSMXMSAXAMASAMMAAXMSSSSMMSAMSAAASAMXSXSMMMAMMXXXMASAXSMMAMXXMASAASMA
MAMMMAXAAXMXMAMMMMMSMAASXMAXASAMXSXMAAXAXAAXAAXMAMXMMXXMAXAAAMAXASAAXAXXAXXXAMMSXSASASXMXASXAAXAASASMSSMMMSAMAXAXXMXSAAMMMSXAMXMAXAAAMMMMXAM
MSSXAMSMMMMAMAMAXAAAMSMMAMASXMAMXSAMSMSSSMSMMMMXAMXXXMASXMSSSMMSXMXMSSSMMSSMAMXMAMASMMAMSMAMMMMSMMMMXAMMAAXASMSMMMMAMSSMAXXMAMAMAXSXMXASMSSX
XAMMSAMXAAMASMSMMMSXMAXSSMAMMSMMAMMMXAXAMXMASMSSSXSAMMMAAAAXXMXMMAAXXXAXXAAXSMMMMMAMASXMASAAASAMXSMSMSSSMSSMMAAXAAMAMAXMXMAMMSAMAAMAMSMSAAXA
MSSMMAXMXXSASAAXXAAMXMAMMXAMAAAMAXSAMXSMSASXMAAAAAXMMAXMMMMSXMASXSMSASAMXSMMXMAXAMMSMXMXAMMSMXAMASAAMXMXXXXMMSMSXSSXMASXMXMMMAXMMXSAMAAXMMXA
AXAASAMMAAMAMMMXMASMSSXSASMMSSXSAXMMSXMASASAMMMSMSSXSAMSXSAMXMAXAAAXMMMSMMXXXASMMXMAMMSMSSMAXMAMAMSMSXMMSMSMAXXXAXXXMAMAXASASAMXSASMSMSMXXSS
SSMMMAXMMSSMXXSSMMMMXAAXAAAAMAMXMSMMSXMAMXMAXMXMXMMAXAXSAMMSMXSMSMMSMAXAASMSSMMASMSMXASXMAXAMXAMXXAMAAXAAAXMAXSMSMASMAMSMMSAMAXXMASAAMAXSAXA
MAXMMSMXMMAMSXMAAXXSMMMMSMSXSXSMAAAXSAMMXSMMMMAAAMMSMSMMAMASMAMMMAAXXASMXMAASXSAMAASMXSAXAMSSSSSMMAASMMSSXSASXSAMXXMSSXMAMMMMMMMMAMXMSASMAMX
AXMXMAXXMMAMSASXMMAXAASXMAMMMMSASMSMSAMAAMASASXSMMAAAAAXXMASMXMAXMXMMMMXSMMMSXMAMXAMMMMXMSSXAMXAASXMAXAMAASAMXMSMSMMXMASXMAAMASXMAMAXMXMMAAX
SMSAXXSMSSSMSAMXMXMMXMSAMMMMXAMXMAAASXMMMSASAMMAASXMSMXSAMASXSAMXSXMASXMXXAXMASMSMSMSSSSXMXMMMSSMMMSMMXSMXMAMSMMMXAXAMAMXMMXMASXXXMSMMMMXMXM
XAXXXSAAAAMAMMMMSAMXSAXXMAAMMSMSMXMMMXAAMMMMMMMMMXMAXAAXXMMSMSAMMSAXAMAMMSSMXXMAXAXAAASAMXXMXAXMMSXAXMASMMMAMAAMMMSXSMMXMSMSMASMSAAAAASMMXAA
MAMSXMAMMMMAMAAASASAAAXSSSMSAXMSAMXMXMMSSMXMAMXXAMMMMMMSMSXSXSXMASAMSSXMAXAXSSXAMSMMMSMMXMASASXMASXXMAMXAXSASXSMAAMXMAMXASAAMXMASMSMSMSAASXS
MAMAAAASMXSSSSMXMMMMMMMMAAAMASAXXXXAAXXAMXAASMXSASMXSAMXXMASAMSMXMASAAAMXMMMAAMSXMAXMAMXMAXMAXXMASMMSSXSSMSAMXAMXMMASAMXSMSMSAMMMAXAMAMMMMAA
SXMXXMXMAAMAAMXASMASXAXMMMMMAMMMMMSSSSMAMXXXXAAXMMMAMAXMSMAMAMXMASMMXSXMAMAMAXAAASXMSASAXXXMAMAMMSMAAAMAMXMAMSSMSSXASAMMMAMMSASXSXMXMAMAAMXM
AMSXSAMXMMMMMMMAASAXMXMXAAAMMXXAAMAAAXXXSSSXSAMXSAMMSSMMAMASAMXMAAAAAXAMASXSXSSMMMSASASXMMXMMSMSSXMMXSMAMAMAMXAAAXMAXAMAMAMXMAMAMAMXMSXMMXSX
MAXMASMXAAXASXXAMMMSMAXXXSAMXSSSSSSSMSSXMAAXSAAXSAXXAMASMXMSXXXMSSMMSXMMASAAAXAASAMMMMMAMSAMXAMXAMASMXXAXMMMMMMMMSASXMMSXMXAMAMXSAMXXMMXSAMX
XSSMAMXXAMXMMMMMXAXAMMXSMMXSAMXAXAMXXXMAMXMXSAMMSSMMASXMSAMXMMMXMAMSMASMMMXMXMMMMAMXAAMMAMASMSSMXMAXMAXSMSAAAMAXXXMXAMAAAMSSSMSMSXSXASAAMMSM
XMAAASXSMSAAASXSSSSSXSASAAAMXSMSMMMXMASMMASXMXMXMAMSAMXASMSAXSAMXMSXMAMAXAAXAMXMSMMSSSSXSSMMAAMMAMXXMSMXASMSMXSAMXASMMSSMMAAAXAAXASMMMMMSAAM
MSAMMSASASXSMSAAAAMXAMASMMMXSAMXAMXAMMMAXASAMMMASMMMXSMXMXXMMMXSXMMAMMXSMSMMMXAXAAMMAAXXMAMMMMMSMMMSAXAMXMAMAMXAXAXASXMAXXXSXMMSMXMAXSXMMXSS
AXASAXMMAMAMAMMMMSMMXMXMASAXMXMXAMSXXAXAMXSMMASASXAAMSMMXSMMAMXMASMSMAAMXMXMSSMMSSMMMMXSAMXSXMAMAAXMAMXMMMXMAMXMASAMAXSAMXMMMSXAXMSXMAMAMXXM
SXSMMSAMXMMXXMMXAMXMXMASMMMSMAXMAMAMSSMSAMXXSXSASXXSAXAMAXMSXXASMMAAMMMMASMXMAXAMXXXAXMAMSXMAMMXMMSSSMSSSMSXSMAMAMAXMXMAXXAAXMSMSAMSMXMSAMXX
XMXAAMMASMMSMSSMMMAXAMAMAAXAMAMMAMAXAMXAXAMAMXMAMXMAXXAMAXMAAMMSSMXAMXXSAXAAMAMSAMXSXXASMSASMMSAAMAXMXAMAAMAMXXMAXXMXXMXMSSMMMXMXXMAXMAMMSMS
MASMMXSASAAAAAXAMSMSMSSSSMSXMASASMMSAMXMMXSAAAMMMAAMSSXMSSMMSAAMXMMMSAXMAMSMSSMXASAMXMSMAMAMAASMSMASXMMSMMMAMXMSSSXMAMMAMXAMXSAMSSSMSMMXAAAA
AMAAAAMASMMMMMSAMAAAAAAMAAMXXSXAMAXSXMMXAASMMMMASXSAAAAMAAXAAMAMASAAMMSMAMXAMXASAMMSAXAMMMSSMMMAMAAMAAAAASMXSXAAAAMXAXSAMSXMASASAAAXSAAMSMSM
SXSAMSMAMXXXMXXMSMSMMMSMMXMASAXXSXMMMAXXMMSAMXMAXSAMXSSMSSMSSMMSASMSMMMMASMAMMMMAMXSXSASAXXAMXMXMMSSSMMSSMAASMMMSMAMXMSAXXSMMSXMMSMMXMAXMAMX
"""

print(day4a(input: input)) // 2344